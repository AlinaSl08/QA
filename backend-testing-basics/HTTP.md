# HTTP

**HTTP (HyperText Transfer Protocol, протокол передачи гипертекста)** – это протокол обмена данными между клиентом и сервером.

 
## HTTP-запрос

**HTTP-запрос** – это сообщение, которое клиент отправляет серверу, чтобы получить данные или выполнить действие.

Формат запроса:

``` 
Метод URI HTTP/Версия  

Заголовки  

[Тело запроса]
```
                  
 

**HTTP-запрос включает 3 основные части**:

**1) Стартовая строка**

Содержит:

+ Метод (`GET, POST, PUT, PATCH, DELETE`)

+ Путь URL (`/api/users`)

+ Версию протокола (`HTTP/1.1, HTTP/2`)

Пример:
```
GET /products HTTP/1.1
```
                  

**2) Заголовки (Headers)**

|Заголовок|	Назначение|	Пример|
|:--:|:--:|:--:|
|**Authorization**|	Передача токена или данных авторизации	|`Authorization: Bearer eyJh...`|
|**Content-Type**|	Формат данных в теле запроса	|`Content-Type: application/json`|
|**Accept**	|Какие форматы данных клиент готов принять	|`Accept: application/json`|
|**User-Agent**|	Информация о клиенте (браузер/приложение)	|`User-Agent: Mozilla/5.0`|
|**Cookie**|	Передача cookies на сервер	|`Cookie: session_id=abc123`|
|**Host**	|Указывает домен сервера (обязателен в HTTP/1.1)	|`Host: api.example.com`|
|**Accept-Language**|	Язык интерфейса клиента	|`Accept-Language: en-US`|
|**Referer**|	URL страницы, с которой пришёл запрос	|`Referer: https://example.com/login`|
|**Cache-Control**|	Настройки кэширования со стороны клиента	|`Cache-Control: no-cache`|
 

**3) Тело запроса (Body)**

+ Пример JSON:
``` 
{ 

  "email": "test@mail.com",

  "password": "123456" 

}
```
                  
+ Пример XML:
``` 
<user><name>Alice</name><age>30</age></user>
```
                  
+ Пример "Простой текст" (text/plain):
```
​​​​​​​Привет, это тестовое сообщение.
```

---

## HTTP-ответ

**HTTP-ответ** – это сообщение, которое сервер возвращает клиенту. 

Формат ответа: 
```
HTTP/Версия Код Статус

Заголовки

[Тело ответа]
```
                  

**HTTP-ответ включает 3 основные части**:

**1) Статусная строка**

Содержит:

+ версию протокола (`HTTP/1.1, HTTP/2`)

+ статус-код (`200, 404, 500 и другие`)

+ текстовое описание

Пример:
```
HTTP/1.1 200 OK
```
                  
 

**2) Заголовки (Headers)**

|Заголовок|	Назначение|	Пример|
|:--:|:--:|:--:|
|Content-Type|	Формат данных в теле ответа|	`Content-Type: application/json`|
|Content-Length|	Размер тела ответа в байтах|	`Content-Length: 248`|
|Set-Cookie|	Установка cookie клиенту|	`Set-Cookie: session_id=abc123; HttpOnly`|
|Server|	Информация о ПО сервера|	`Server: nginx/1.18`|
|Cache-Control|	Настройки кэширования со стороны сервера|	`Cache-Control: max-age=3600`|
|Access-Control-Allow-Origin|	Кому разрешён доступ (CORS)|	`Access-Control-Allow-Origin: *`|
|Connection|	Управление соединением|	`Connection: keep-alive`|
|Retry-After|	Через сколько повторить запрос| 	`Retry-After: 120`|
 

**3) Тело ответа (Body)**

+ HTML‑страница;
+ JSON‑данные;
+ изображение (в двоичном виде).

Пример JSON:
``` 
​​​​​​​{"id": 42, "name": "Alice"}
```

---

## HTTPS

**HTTPS (HyperText Transfer Protocol Secure)** – это расширение протокола HTTP, обеспечивающее защищённую передачу данных между клиентом и сервером.

**Ключевое отличие от HTTP**:

+ данные передаются через зашифрованное соединение (используя TLS/SSL);
+ SSL (Secure Sockets Layer, "слой защищённых сокетов") и TLS (Transport Layer Security, "протокол защиты транспортного уровня") – криптографические протоколы для защищённой передачи данных между клиентом и сервером в сети.
 

**Работа HTTPS (упрощённо)**:

1. Клиент подключается к серверу.
2. Сервер отправляет свой SSL-сертификат.
3. Клиент проверяет сертификат у доверенного центра.
4. Генерируется сеансовый ключ для шифрования данных.
5. Устанавливается зашифрованный канал – все дальнейшие данные передаются в зашифрованном виде.

Все HTTP-запросы и ответы остаются теми же, просто теперь они проходят через шифровку.

 

**Отличия HTTPS от HTTP в запросах/ответах**:

1) Визуальные признаки (для пользователя):

+ URL начинается с `https://` (а не `http://`)
+ В адресной строке – значок замка, щита или другое (зависит от браузера)


2) Технические отличия: 

+ Порт: HTTPS использует порт `443` (HTTP `80`).
+ Шифрование: все данные (заголовки, тело запроса/ответа) шифруются.

---
# Методы HTTP

**Методы HTTP (HTTP Methods)** – это команды, которые клиент отправляет серверу, чтобы указать, какое действие нужно выполнить над ресурсом. У HTTP методов есть свойства: Идемпотентность и Безопасность.

 

**Безопасные методы** – это методы, выполнение которых не модифицирует ресурсы на сервере и не влияет на состояние системы.

Пример:
```
GET /products -- просто получение данных
```
                  
**Небезопасные методы** — это методы, выполнение которых может изменить ресурсы: создать, обновить или удалить данные.

Пример:
```
POST /users -- создаёт нового пользователя
```
                  
 

**Идемпотентный метод **– это метод, выполняющийся так, что многократные одинаковые запросы приводят к такому же результату, что и один запрос.

Пример:
```
GET /brands -- просто получение данных. Повторный запрос приведет к тому же результату
```
                  
**Неидемпотентный метод** – это метод, который может вести себя по-разному при повторном выполнении одного и того же запроса, создавая разные результаты.

Пример:
```
POST /category -- создаёт новую категорию. Два одинаковых POST могут создать два разных ресурса
```
                  
 

**Основные методы HTTP**:

1) **`GET`**

+ Назначение: получение данных с сервера
+ Идемпотентный: да 
+ Безопасный: да 
+ Особенности: тело в запросе обычно не используется, но может быть

Пример:
```
GET /api/posts
```
                  
 
2) **`POST`**

+ Назначение: отправка данных на сервер для обработки
+ Идемпотентный: нет 
+ Безопасный: нет 
+ Особенности: данные передаются в теле запроса

Пример:
```
POST /api/users 


{"name": "Иван", "email": "ivan@example.com"}
```
                  
 

3) **`PUT`**

+ Назначение: полное обновление ресурса 
+ Идемпотентный: да 
+ Безопасный: нет 
+ Особенности: данные передаются в теле запроса. Требуется указать весь объект

Пример:
```
PUT /api/users/123 

{"name": "Иван Иванов", "phone": "+79991234567"}
```
                  
 

4) **`PATCH`**

+ Назначение: частичное обновление ресурса
+ Идемпотентный: условно (зависит от реализации)
+ Безопасный: нет
+ Особенности: данные передаются в теле запроса. Меняет только указанные поля, остальные остаются без изменений

**Отличие от PUT**: PATCH меняет только указанные поля, остальные остаются без изменений

Пример:
```
PATCH /api/users/123 

{"email": "new@example.com"}
```
                  
 

5) **`DELETE`**

+ Назначение: удаление ресурса
+ Идемпотентный: да
+ Безопасный: нет 

Пример:
```
DELETE /api/users/123
```
                  
 

6) **`HEAD`**

+ Назначение: получить только заголовки ответа (без тела).
+ Идемпотентный: да
+ Безопасный: да

Пример:
```
HEAD /api/posts/456 
```
                  
 

7) **`OPTIONS`**

+ Назначение: узнать, какие методы поддерживаются для ресурса
+ Идемпотентный: да
+ Безопасный: да

Пример:

```
OPTIONS /api/users
```

|Метод|	Безопасный|	Идемпотентный|	Пример действия|
|:--:|:--:|:--:|:--:|
|**GET**|	+|	+|	Получить данные|
|**HEAD**|	+|	+	|Проверить доступность|
|**OPTIONS**|	+	|+	|Узнать доступные методы|
|**POST**|	-|	-	|Создать ресурс|
|**PUT**|	-	|+|	Полностью обновить ресурс|
|**PATCH**|	-|	- / +	|Частично обновить ресурс|
|**DELETE**|	-	|+|	Удалить ресурс|

---
# Статус HTTP

**Статус HTTP** (статус‑код, status code) – это трёхзначное число в ответе сервера, которое сообщает клиенту результат обработки запроса.

**Статус код находится** в первой строке HTTP‑ответа:
```
HTTP/1.1 200 OK
```
                  
**Состоит**:

+ **Первая цифра** – класс статуса (определяет общую категорию).
+ **Остальные две** – конкретный код внутри категории.
 

**Все статусы делятся на 5 категорий по первой цифре**:

|Группа|	Категория	|Пример|
|:--:|:--:|:--:|
|1xx|	Информационные|	101 Switching Protocols|
|2xx|	Успех|	200 OK|
|3xx|	Перенаправление|	301 Moved Permanently|
|4xx|	Ошибки клиента|	404 Not Found|
|5xx|	Ошибки сервера|	500 Internal Server Error|
 

**Таблица часто встречающихся HTTP‑статусов с примерами**

+ 2xx – Успешные ответы

|Код|	Название|	Пример|
|:--:|:--:|:--:|
|200|	OK|	`GET /users/5`  возвращаются данные пользователя|
|201|	Created|	`POST /users` создаётся новый пользователь|
|204|	No Content|	`DELETE /cart/7` товар удалён, тело ответа пустое|

+ 3xx – Перенаправления

|Код|	Название|	Пример|
|:--:|:--:|:--:|
|301|	Moved Permanently|	Старый URL автоматически ведёт на новый (`http-->https`)|
|302|	Found|	Пользователь без авторизации перенаправляется на страницу логина|

+ 4xx – Ошибки клиента

|Код|	Название|	Пример|
|:--:|:--:|:--:|
|400|	Bad Request|	Отправлен сломанный JSON или неверные данные|
|401|	Unauthorized|	Запрос без токена `-->` сервер отказывает|
|403|	Forbidden	|Пользователь пытается открыть админ-панель без прав|
|404|	Not Found|	`GET /users/9999`  пользователя нет|
|409|	Conflict|	Создание пользователя с email, который уже существует|
|412|	Precondition Failed|	Попытка обновить ресурс устаревшей версией|

+ 5xx – Ошибки сервера

|Код|	Название|	Пример|
|:--:|:--:|:--:|
|500|	Internal Server Error|	Ошибка в коде сервера, баг в обработке запроса|
|501|	Not Implemented|	API не реализует метод, например `PUT /orders`|
|502|	Bad Gateway|	Микросервис A не может связаться с микросервисом B|
|503|	Service Unavailable	|Сервер перегружен или проводятся техработы|
